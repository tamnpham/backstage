apiVersion: backstage.io/v1beta2
kind: Template
metadata:
  name: yaml-creator-template
  title: YAML File Creator Template
  description: Tạo các file YAML và tạo PR trên GitHub
spec:
  owner: team-name
  type: service

  steps:
    - id: fetch-base
      name: Fetch Base
      action: fetch:plain
      input:
        url: ./path/to/your/template/directory

    - id: template
      name: Template YAML files
      action: template
      input:
        files:
          - destination: "${{ parameters.path }}/file.yaml"
            content: |
              key: ${{ parameters.value }}

    - id: publish
      name: Create Pull Request
      action: publish:github:pull-request
      input:
        repoUrl: ${{ parameters.repoUrl }}
        branchName: 'auto-create-yaml-${{ parameters.projectName }}'
        title: 'Auto-create YAML files'
        body: 'This PR is auto-generated by Backstage.'
        sourcePath: './path/inside/the/workspace'

  parameters:
    - title: YAML File Creation
      required:
        - repoUrl
        - path
        - value
        - projectName
      properties:
        repoUrl:
          title: Repository URL
          type: string
          description: 'The URL for the GitHub repository. Example: https://github.com/my-org/my-repo'
        path:
          title: Destination Path
          type: string
          description: 'File path where the YAML file will be created.'
        value:
          title: Key Value
          type: string
          description: 'The value for the key in the YAML file.'
        projectName:
          title: Project Name
          type: string
          description: 'A unique name for the project.'